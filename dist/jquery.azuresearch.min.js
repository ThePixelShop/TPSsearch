!function(e){var a={azureSearch:{url:"",key:"",isFuzzy:!1,fuzzyProximity:0,isWildcard:!1,useTermProximity:!1,termProximityDistance:0},googleGeocodeApi:{key:null,url:"https://maps.googleapis.com/maps/api/geocode/json",language:"en"},geoSearch:{lat:null,lng:null,fieldName:"_distance",azureFieldName:null,unit:"K",maxDistance:null},searchParams:{search:"*",facets:[],count:!0,top:null,skip:0,filter:null,orderby:null,queryType:"full"},dates:{hasDates:!1,fields:{zone:"EST",from:{indexField:null,fieldId:null},to:{indexField:null,fieldId:null}}},facets:{facet:'<a href="#"/>',facetAltText:"Filter results by ",facetClass:"facet",titleWrapper:"<h2/>",title:'<a href="#"/>',titleClass:"",titleOnClick:function(){},titleWrapperClass:"facet-title",container:"#facets",wrapperContainer:"<ul/>",wrapperContainerClass:"facet-list",wrapper:"<li/>",wrapperClass:"facet-item",showCount:!0,countWrapper:null,countWrapperClass:null,facetOnClick:function(r){r.preventDefault();var s=e(this).data("azuresearchFacetName"),n=e(this).val()?e(this).val():e(this).data("azuresearchFacetValue"),l=e(this).data("azuresearchFacetTranslationField"),i=e(this).data("azuresearchFacetTranslationKey"),o=e(this).data("azuresearchFacetOperator")+"||"+s+"||"+n;l&&i&&(o+="||"+l+"||"+i);if("change"===r.type&&"checkbox"===r.target.type&&!1===e(this).prop("checked")){var p=a.facetsApplied;c(e("."+p.class+'[data-value="'+o+'"]'))}else{if(-1!==a.facetsSelected.indexOf(o))return;a.facetsSelected.push(o),a.facetsApplied.onChange.call(a.facetsSelected.slice(0)),a.facets.onFacetSelect.call(a.facetsSelected.slice(0)),a.searchParams.skip=0,t.currentPage=1,d()}},searchMode:"and",onFacetSelect:function(){var r=a.results,s=a.facetsApplied,n=a.facets;if(!s.container)return;var l=this.pop(),i=e(s.container),o=l.split("||");if(p(o),-1!==s.ignoreFacets.indexOf(o[1]))return;r.labels.activeFacets&&!t.hasActiveFacets&&i.prepend(e("<span/>").addClass("selected-facet-label").text(r.labels.activeFacets));var u=null,f=null,h=o[1],g=a.facetsDictionary.concat(t.additionalFacetsDictionary);i.find('.selected-facets-group[data-az-field="'+h+'"]').length>0&&s.groupFacetsByType?u=i.find('.selected-facets-group[data-az-field="'+h+'"]'):s.groupFacetsByType&&(u=e("<div/>").addClass("selected-facets-group").attr("data-az-field",h).appendTo(i),f=h,e.each(g,function(e,a){return a.fieldName===o[1]&&void(f=a.label)}),e("<span/>").addClass("selected-facets-group-title").text(f).appendTo(u));var m=o[2];if(n.translateFacets){var v=o[3]?o[3]:o[1],y=o[4]?o[4]:o[2];m=n.translateFacets.call(v,y)}var P=e("<a/>").text(m).attr({href:"#"}).attr(s.extraAttributes).data("value",l).addClass(s.class).on("click",function(a){a.preventDefault(),c(e(this))});s.groupFacetsByType?P.appendTo(u):t.clearAllAdded?P.insertBefore(".clear-all-facets"):P.appendTo(i);s.clearAll.enabled&&!t.clearAllAdded&&(e("<a/>").text(s.clearAll.label).attr({href:"#"}).attr(s.extraAttributes).addClass("clear-all-facets").addClass(s.clearAll.className).on("click",function(e){e.preventDefault(),t.clearAllAdded=!1,t.hasActiveFacets=!1,i.empty().hide(),a.facetsSelected=[],a.searchParams.skip=0,t.currentPage=1,a.facetsApplied.onChange.call(a.facetsSelected),d()}).appendTo(i),t.clearAllAdded=!0);t.hasActiveFacets=!0,i.show()},groupWrapper:"<div/>",groupWrapperClass:"group",emptyFacetText:"(none)",sortFacets:null,translateFacets:null},facetsApplied:{container:null,class:"selected-facet",extraAttributes:{},ignoreFacets:[],groupFacetsByType:!1,updateHistory:!1,clearAll:{enabled:!0,label:"Clear all",className:""},onChange:function(){}},facetsDictionary:[],facetsSelected:[],results:{container:"#results",template:null,noResultsClasses:"",onCreate:function(){},loaderContainer:null,resultsMsgContainer:null,pager:{container:null,loadMore:!0,infinite:!1,infiniteClick:!1,appendPager:!1,pageSize:50,pagerRangeIncrement:5,pagerItems:!0,pagerEnders:!1,updateHistory:!1,labels:{prev:"Previous",next:"Next",first:"First",last:"Last",load:"load more",ada:{current:"You are on page",item:"Go to page",prev:"Go to the previous page of results",next:"Go to the next page of results",first:"Go to the first page of results",last:"Go to the last page of results",load:"Load more results"}},classes:{prev:"",next:"",last:"",results:"",load:""},onRender:function(){},onPageChange:function(){}},labels:{activeFacets:"Filters",noResults:"Sorry there are no results for your query",haveResults:"Results Found {count}",haveQuery:"Your search for {query} returned {count}"}},urlParameters:{address:"a",latitude:"l",longitude:"ln",latlong:null,search:"q",facets:"fc",page:"p"},orderbyOptions:{orderbySelector:null,orderbyEvent:"click",onOrderbyChange:function(t){var r=e(this).data("searchField"),s=e(this).data("searchDir");"SELECT"===e(this)[0].nodeName&&(r=e(this).find(":selected").data("searchField"),s=e(this).find(":selected").data("searchDir"));a.searchParams.skip=0,a.searchParams.orderby="",r.split(";").forEach(function(e,t,r){t>0&&(a.searchParams.orderby+=", "),a.searchParams.orderby+=e+" "+s}),d()}},onResults:function(){i(this),function(r){var s=a.results,n=e(s.loaderContainer),l=e(s.container)?e(s.container):e(t.container);if(!l||!r.value)return;(function(r){var s=a.results,n=e(s.resultsMsgContainer);if(n){n.empty();var l='<span class="query-count">'+r+"</span>",c='<span class="page-count">'+t.currentPage*s.pager.pageSize+"</span>",i=t.currentPage,o=t.currentPage*s.pager.pageSize;i>1&&(i=(t.currentPage-1)*s.pager.pageSize),o>t.totalResults&&(o=t.totalResults);var d='<span class="page-count">'+i+"</span>",p='<span class="page-count">'+o+"</span>",u=s.labels.haveResults;if(t.queryText||t.queryTextName){var f='<span class="query-text">'+h(t.queryText)+"</span>",g='<span class="query-text">'+h(t.queryTextName)+"</span>";t.queryText&&t.queryTextName?u=s.labels.haveQueryAndName:t.queryText&&!t.queryTextName?u=s.labels.haveQuery:!t.queryText&&t.queryTextName&&(u=s.labels.haveName),u=u.replace("{name}",g).replace("{query}",f)}u=u.replace("{count}",l).replace("{showing}",c).replace("{currPage}",t.currentPage).replace("{totalPages}",t.totalPages).replace("{pbottom}",d).replace("{ptop}",p);var m=e("<span/>").append(u);n.empty().fadeOut(function(){m.appendTo(n),n.fadeIn()})}})(r["@odata.count"]),(!s.pager.loadMore&&!s.pager.infinite||0===a.searchParams.skip)&&l.html("");s.pager.infinite&&!t.rendered&&l.attr("role","feed").attr("aria-busy","true");0===r["@odata.count"]&&(n&&n.fadeOut(),e("<div/>").addClass("search-no-results "+s.noResultsClasses).text(s.labels.noResults).appendTo(l));e(r.value).each(function(r,c){if(s.template){var i=e("<div>"+s.template+"</div>");e(':not([data-search-field=""])',i).each(function(s,n){var l,i,o,d,p,u,f,h,g,m,v=e(n).data("searchField"),y="";if(v&&c[v])y=c[v];else if(v===a.geoSearch.fieldName&&t.isGeoSearch&&c[a.geoSearch.azureFieldName]){var P=c[a.geoSearch.azureFieldName];l=a.geoSearch.lat,i=a.geoSearch.lng,o=P.coordinates[1],d=P.coordinates[0],p=a.geoSearch.unit,u=Math.PI*l/180,f=Math.PI*o/180,h=i-d,g=Math.PI*h/180,(m=Math.sin(u)*Math.sin(f)+Math.cos(u)*Math.cos(f)*Math.cos(g))>1&&(m=1),m=60*(m=180*(m=Math.acos(m))/Math.PI)*1.1515,"K"===p&&(m*=1.609344),"N"===p&&(m*=.8684),y=m}var S=e(n).data("searchValueFormat");S&&window[S]&&(y=window[S](y,c,r)),v&&(void 0!==e(n).data("searchValueFormatReplace")?e(n).replaceWith(y):e(n).html(y))}),l.append(i.children()),n&&n.fadeOut(),s.onCreate.call(i)}else{var o=e("<ul/>"),d=e("<hr/>");e(Object.keys(c)).each(function(a,t){if(!c[t]||""===c[t])return!0;var r=e("<li/>").text(t+" : ").appendTo(o);e("<strong/>").text(c[t]).appendTo(r)}),o.appendTo(l),d.appendTo(l),s.onCreate.call(o)}}),s.pager.infinite&&l.attr("aria-busy","false");l.fadeIn(),t.rendered=!0}(this),this["@odata.count"]>a.results.pager.pageSize&&function(r){var c=a.results.pager;if(c.appendPager){var i=e(c.container);i.empty(),t.pagerRendered||(t.pagerRange[0]=1,t.pagerRange[1]=c.pagerRangeIncrement,t.currentPage>=c.pagerRangeIncrement&&(t.pagerRange[0]=Math.floor(t.currentPage/c.pagerRangeIncrement)*c.pagerRangeIncrement,t.pagerRange[1]=(Math.floor(t.currentPage/c.pagerRangeIncrement)+1)*c.pagerRangeIncrement)),function(){var r=a.results.pager,c=e(r.container);if(!c)return;if(r.loadMore||r.infinite)c.append(s("load"));else{var i="";if(r.pagerEnders&&c.append(s("first")),c.append(s("prev")),r.pagerItems){i=t.pagerRendered?e(".pager-nav-items").empty():e("<div/>").addClass("pager-nav-items");for(var o=t.pagerRange[0];o<=t.pagerRange[1]&&o<=t.totalPages;){var d=e('<a href="#">').data("targetPage",o);o===t.currentPage?(d=e("<span>").addClass("pager-nav-item-current")).attr("title",r.labels.ada.current+" "+o):d.attr("title",r.labels.ada.item+" "+o),d.addClass("pager-nav-item").text(o),i.append(d),o++}}c?(c.append(i),c.append(s("next")),r.pagerEnders&&c.append(s("last"))):(c.append(s("next")),r.pagerEnders&&c.append(s("last")),e(t.container).after(c))}t.pagerListenersAdded||function(){var r=a.results.pager;if(r.loadMore||r.infinite){if(e(document).on("click",".pager-load",function(a){a.preventDefault(),e(this).data("disabled")||(n(e(this).hasClass("pager-prev")),r.infinite&&r.infiniteClick&&(t.pagerInifiniteClicked=!0))}),r.infinite){var s=e(".pager-load");r.infiniteClick||(t.pagerInifiniteClicked=!0),e(window).on("resize scroll",function(){(function(a,t){void 0===t&&(t=0);var r=a.offset().top,s=r+a.outerHeight(),n=e(window).scrollTop(),l=n+e(window).height()-t;return s>n&&r<l})(s,150)&&t.pagerInifiniteClicked&&!s.data("disabled")&&n(s.hasClass("pager-prev"))})}}else e(document).on("click",".pager-prev, .pager-next",function(a){a.preventDefault(),e(this).data("disabled")||n(e(this).hasClass("pager-prev"))}),e(document).on("click",".pager-last, .pager-first",function(a){a.preventDefault(),e(this).data("disabled")||l(e(this).data("targetPage"))}),e(document).on("click",".pager-nav-items a",function(a){a.preventDefault(),l(e(this).data("targetPage"))});t.pagerListenersAdded=!0}()}(),i.fadeIn(),t.pagerRendered=!0}}();a.onLoad.call(this,t)},onLoad:function(){},debug:!1},t={container:null,totalPages:0,currentPage:1,pagerRange:[],pagerRendered:!1,pagerListenersAdded:!1,pagerInifiniteClicked:!1,waitingLatLong:!1,isGeoSearch:!1,totalResults:0,initialized:!1,rendered:!1,dateSearch:!1,fromDate:null,toDate:null,clearAllAdded:!1,queryText:null,hasActiveFacets:!1,returnedParams:null,additionalFacetsDictionary:[]};function r(e){p("Google Geocode return:"),p(e);"OK"===e.status&&e.results.length>0&&(a.geoSearch.lat=e.results[0].geometry.location.lat,a.geoSearch.lng=e.results[0].geometry.location.lng),t.waitingLatLong=!1,d()}function s(r){var s=a.results.pager,n=e("<a/>").addClass("pager-navs").addClass("pager-"+r).attr("href","#").attr("title",s.labels.ada[r]);return n.append(e("<span/>").addClass("pager-navs-label").text(s.labels[r])),s.classes[r]&&n.addClass(s.classes[r]),"first"===r?n.data("targetPage",1):"last"===r&&n.data("targetPage",t.totalPages),t.pagerRendered&&(n=e(".pager-navs.pager-"+r)),!s.infinite||!t.pagerInifiniteClicked&&s.infiniteClick||n.addClass("pager-load-infinite"),"prev"===r||"first"===r?t.currentPage>1?n.data("disabled",!1).removeClass("disabled"):n.data("disabled",!0).addClass("disabled"):t.totalPages>t.currentPage?n.data("disabled",!1).removeClass("disabled"):n.data("disabled",!0).addClass("disabled"),n}function n(e){var r=a.results.pager;r.pageSize&&t.currentPage&&t.rendered&&(t.rendered=!1,t.currentPage=e?t.currentPage-1:t.currentPage+1,a.searchParams.skip=(t.currentPage-1)*r.pageSize,d())}function l(e){t.currentPage=e,a.searchParams.skip=(t.currentPage-1)*a.results.pager.pageSize,d()}function c(r){var s=a.facetsApplied;if(s.container){var n=e(s.container);a.facetsSelected.splice(a.facetsSelected.indexOf(r.data("value")),1),a.searchParams.skip=0,t.currentPage=1,a.facetsApplied.onChange.call(a.facetsSelected.slice(0)),a.facetsApplied.groupFacetsByType&&r.parent('.selected-facets-group[data-az-field="'+fs[1]+'"]').children(".selected-facet").length<=1?r.parent('.selected-facets-group[data-az-field="'+fs[1]+'"]').remove():r.remove(),n.children().not(".clear-all-facets, .selected-facet-label").length>0||(t.hasActiveFacets=!1,t.clearAllAdded=!1,n.empty().hide()),d()}}function i(t,r,s){r||(r=a.facets),s||(s=a.facetsDictionary);var n=e(r.container);n&&t["@search.facets"]&&(n.html(""),e.each(s,function(s,l){var c=l.fieldName;if(t["@search.facets"][c]){var i=l;i="object"==typeof l&&l.label?l.label:c;var d=e(r.title).addClass(r.titleClass).text(i);r.titleWrapper&&(d=e(r.titleWrapper).addClass(r.titleWrapperClass).append(d)),n.append(d),d.on("click",r.titleOnClick);var p=e(r.wrapperContainer).addClass(r.wrapperContainerClass);n.append(p),"object"==typeof l&&"select"===l.tagname?function(t,r,s,n,l,c){c||(c=a.facets);var i=e(c.container),o=e("<select />").data("azuresearchFacetName",n).on("change",c.facetOnClick).append(e("<option />").text("Select"));t.append(o);var d=0,p=s["@search.facets"][n];c.sortFacets&&(p=c.sortFacets.call(this,n,s["@search.facets"][n]));if(e(p).each(function(t,r){!r.label&&c.translateFacets&&(r.label=c.translateFacets.call(this,n,r.value));var s=r.label?r.label:r.value,l=e("<option />").text(s).attr("value",r.value).data("azuresearchFacetName",n);r.translation_field&&r.translation_key&&(l.data("azuresearchFacetTranslationField",r.translation_field),l.data("azuresearchFacetTranslationKey",r.translation_key)),c.showCount&&r.count&&l.text(l.text()+" ("+r.count+")"),-1!==a.facetsSelected.indexOf(n+"||"+r.value)&&l.attr("selected","selected"),o.append(l),d++}),c.groupWrapper&&d>0){var u=e(c.groupWrapper).addClass(c.groupWrapperClass);i.append(u),r.appendTo(u),t.appendTo(u)}0===d&&(r.remove(),t.remove())}(p,d,t,c,0,r):function(t,r,s,n,l,c){c||(c=a.facets);var i,d,p=e(c.container);"object"==typeof l&&(i=l.tagname,d=l.operator);var u=0,f=s["@search.facets"][n];c.sortFacets&&(f=c.sortFacets.call(this,n,s["@search.facets"][n]));if(e(f).each(function(r,s){var l=a.facets;!s.label&&l.translateFacets&&(s.label=l.translateFacets.call(this,n,s.value));var c=o(s,n,i,d);if(l.wrapper){var p=e(l.wrapper).addClass(l.wrapperClass);p.append(c).appendTo(t)}else t.append(c);s.children&&e(s.children).each(function(a,t){l.translateFacets&&!t.label&&(s.label=l.translateFacets.call(this,n,t.value));var r=o(t,n,i,d);p&&(p.addClass("has-child-facets"),e(l.wrapper).addClass(l.wrapperClass).append(r).appendTo(p),p.find(".active-facet").length>0&&p.addClass("expanded"))}),u++}),c.groupWrapper&&u>0){var h=e(c.groupWrapper).addClass(c.groupWrapperClass);p.append(h),r.appendTo(h),t.appendTo(h)}0===u&&(r.remove(),t.remove())}(p,d,t,c,l,r)}}))}function o(t,r,s,n){var l=a.facets;n||(n=l.searchMode);var c,i=n+"||"+r+"||"+t.value,o=t.label?t.label:t.value,d=o;if(l.showCount&&t.count&&(d+=' <span class="facet-count">('+t.count+")</span>"),"radio"===s||"checkbox"===s){let a=r+"_"+t.value.replace(/\W/g,"");c=e("<input />").on("change",l.facetOnClick).attr({type:s,name:r,id:a,value:t.value});var p=e("<label />").html(d).attr("for",a).attr("title",l.facetAltText+o),u=e("<div>").append(c).append(p)}else c=e('<a href="#"/>').on("click",l.facetOnClick).attr("title",l.facetAltText+o).html(d);return c.addClass(l.facetClass).data("azuresearchFacetName",r).data("azuresearchFacetValue",t.value).data("azuresearchFacetOperator",n),t.translation_field&&t.translation_key&&(c.data("azuresearchFacetTranslationField",t.translation_field),c.data("azuresearchFacetTranslationKey",t.translation_key),i+="||"+t.translation_field+"||"+t.translation_key),-1!==a.facetsSelected.indexOf(i)&&(c.addClass("active-facet"),"radio"!==s&&"checkbox"!==s||c.prop("checked",!0)),void 0!==u?u:c}function d(){if(a.results.pager.updateHistory&&function(){var e,r,s,n,l;e=window.location.pathname+window.location.search,s=a.urlParameters.page,r=e.indexOf(s)>-1?f(e,s):e;t.currentPage>1?(n=t.currentPage.toString(),l=r,l+=r.indexOf("?")>-1?"&":"?",l+=s+"="+n):l=r;window.history.replaceState({url:l},"page",l.replace(/%3Cscript%3E/g,""))}(),a.facetsApplied.updateHistory&&function(){var t,r,s,n,l;r=window.location.pathname+window.location.search,t=a.urlParameters.facets,s=r.indexOf(t)>-1?f(r,t):r;a.facetsSelected.length>0?(n="",e.each(a.facetsSelected,function(e,a){e>0&&(n+=";"),n+=encodeURIComponent(a.toString())}),l=s,l+=s.indexOf("?")>-1?"&":"?",l+=t+"="+n):l=s;window.history.replaceState({url:l},"",l.replace(/%3Cscript%3E/g,""))}(),t.returnedParams={groupedFacets:null,params:null,azureKeys:null},t.isGeoSearch=!1,a.results.loaderContainer&&e(a.results.loaderContainer).fadeIn(),a.results.pager.container&&e(a.results.pager.container).empty().fadeOut(),a.results.resultsMsgContainer&&e(a.results.resultsMsgContainer).empty().fadeOut(),t.pagerRendered=!1,!t.waitingLatLong){if(a.geoSearch.lat&&a.geoSearch.lng&&(p("Geo searching..."),p(a.geoSearch.lat),p(a.geoSearch.lng),t.isGeoSearch=!0,!a.searchParams.orderby||0===a.searchParams.orderby.indexOf(a.geoSearch.fieldName))){var r="geo.distance("+a.geoSearch.azureFieldName;r+=", geography'POINT("+a.geoSearch.lng+" "+a.geoSearch.lat+")')",a.searchParams.orderby&&-1!==a.searchParams.orderby.indexOf(" desc")&&(r+=" desc"),a.searchParams.orderby=r}var s=null,n=a.searchParams.filter;if(a.searchParams.facets=[],a.facetsDictionary.length>0&&e(Object.keys(a.facetsDictionary)).each(function(e,t){var r=null;"object"==typeof a.facetsDictionary[t]&&a.facetsDictionary[t].params&&(r=a.facetsDictionary[t].fieldName+",",r+=a.facetsDictionary[t].params,a.searchParams.facets.push(r))}),t.returnedParams.groupedFacets=null,a.facetsSelected.length>0){var l="",c=function(){var e={};return a.facetsSelected.forEach(function(a,t){var r=a.split("||");void 0===e[r[0]]&&(e[r[0]]={}),void 0===e[r[0]][r[1]]&&(e[r[0]][r[1]]=[]),e[r[0]][r[1]].push(r[2])}),e}();t.returnedParams.groupedFacets=c,e.each(c,function(a,t){e.each(t,function(t,r){var s=0;e.each(r,function(e,r){"or"===a&&0===s&&(l+=" and ("),("and"===a||s>0)&&(l+=" "+a+" "),l+=t+"/any(m: m eq '"+r+"')",s++}),"or"===a&&(l+=")")})}),s=l,n&&(s=a.searchParams.filter+" "+s)}if(t.isGeoSearch&&a.geoSearch.maxDistance){p("Filter Geo searching by distance : "+a.geoSearch.maxDistance);var i="geo.distance("+a.geoSearch.azureFieldName+", geography'POINT("+a.geoSearch.lng+" "+a.geoSearch.lat+")') le "+a.geoSearch.maxDistance;s?s+=" "+a.facets.searchMode+" "+i:(s=i,n&&(s=a.searchParams.filter+" "+a.facets.searchMode+" "+s))}var o="";t.dateSearch&&(t.fromDate&&(o=a.dates.fields.from.indexField+" ge "+t.fromDate.toISOString()),t.toDate&&(t.fromDate&&(o+=" "+a.facets.searchMode+" "),o+=a.dates.fields.to.indexField+" le "+t.toDate.toISOString()),s?s+=" "+a.facets.searchMode+" "+o:(s=o,n&&(s=a.searchParams.filter+" "+a.facets.searchMode+" "+s))),s&&(a.searchParams.filter=s),a.searchParams.search=function(e){var t=e;if(e){var r=e.trim().replace(/[\\]{1}/gi,"\\").replace(/[\"]{1}/gi,"$&").replace(/[\~\?\*\:\/\^\[\]\(\)\{\}\!\+\-]{1}/gi," ").replace(/(\s\&\s)/gi," \\& ").replace(/(\&){2}/gi,"\\$&").replace(/(\|){2}/gi,"\\$&").trim();if(t="("+r+")",-1===e.indexOf('"')){if("full"===a.searchParams.queryType&&a.azureSearch.useTermProximity){var s='"'+r+'"~'+a.azureSearch.termProximityDistance;t+=" | ("+s+")"}if("full"===a.searchParams.queryType&&a.azureSearch.isFuzzy&&a.azureSearch.fuzzyProximity>0){var n=r.replace(/[\s^]+(?=([^\"]*\"[^\"]*\")*[^\"]*$)(?=([^\']*\'[^\']*\')*[^\']*$)/gi,"~"+a.azureSearch.fuzzyProximity+" ")+"~"+a.azureSearch.fuzzyProximity;t+=" | ("+n+")"}if(a.azureSearch.isWildcard){const e=r.replace(/[\s^]+(?=([^\"]*\"[^\"]*\")*[^\"]*$)(?=([^\']*\'[^\']*\')*[^\']*$)/gi,"* ")+"*";t+=" | ("+e+")"}}}return t}(t.queryText),t.returnedParams.params={search:a.searchParams.search?a.searchParams.search:"*",filter:a.searchParams.filter?a.searchParams.filter:"",orderby:a.searchParams.orderby?a.searchParams.orderby:"",queryType:a.searchParams.queryType?a.searchParams.queryType:"simple",searchMode:a.searchParams.searchMode?a.searchParams.searchMode:"all",searchFields:a.searchParams.searchFields?a.searchParams.searchFields:""},t.returnedParams.azureKeys=a.azureSearch,p(t.returnedParams);var d={crossDomain:!0,url:a.azureSearch.url,method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","api-key":a.azureSearch.key,"Cache-Control":"no-cache"},data:JSON.stringify(a.searchParams)};e.ajax(d).done(function(e){t.totalResults=a.searchParams.count&&e["@odata.count"]?e["@odata.count"]:-1,t.totalPages=Math.ceil(t.totalResults/a.results.pager.pageSize),a.onResults.call(e,t)}),a.searchParams.filter=n}}function p(e){a.debug&&window.console&&window.console.log&&window.console.log(e)}function u(e){if(!e)return null;var a,t,r=window.location.search.substring(1).split(/(\&){1}(?!\&)/gi);for(t=0;t<r.length;t++)if((a=r[t].split("="))[0]===e)return void 0===a[1]||decodeURIComponent(a[1].replace(/\+/g," "));return null}function f(e,a,t){var r=e.indexOf("#"),s=-1===r?"":e.substr(r);e=-1===r?e:e.substr(0,r);var n=new RegExp("([?&])"+a+"=.*?(&|$)","i"),l=-1!==e.indexOf("?")?"&":"?";return t?e=e.match(n)?e.replace(n,"$1"+a+"="+t+"$2"):e+l+a+"="+t:("?"===(e=e.replace(new RegExp("([?&]?)"+a+"=[^&]*","i"),"")).slice(-1)&&(e=e.slice(0,-1)),-1===e.indexOf("?")&&(e=e.replace(/&/,"?"))),e+s}function h(a){return e("<textarea/>").text(a).html()}e.fn.azuresearch=function(s,n){switch(t.container=this,n||(n="search"),s&&(s.azureSearch&&(s.azureSearch=e.extend(a.azureSearch,s.azureSearch)),s.googleGeocodeApi&&(s.googleGeocodeApi=e.extend(a.googleGeocodeApi,s.googleGeocodeApi)),s.geoSearch&&(s.geoSearch=e.extend(a.geoSearch,s.geoSearch)),s.searchParams&&(s.searchParams=e.extend(a.searchParams,s.searchParams)),s.dates&&(s.dates=e.extend(!0,a.dates,s.dates)),s.facets&&(s.facets=e.extend(a.facets,s.facets)),s.facetsApplied&&(s.facetsApplied=e.extend(!0,a.facetsApplied,s.facetsApplied)),s.results&&(s.results=e.extend(!0,a.results,s.results)),s.urlParameters&&(s.urlParameters=e.extend(a.urlParameters,s.urlParameters)),s.orderbyOptions&&(s.orderbyOptions=e.extend(a.orderbyOptions,s.orderbyOptions)),(a=e.extend(a,s)).searchParams.top=a.results.pager.pageSize,t.currentPage=a.searchParams.skip/a.searchParams.top+1,t.clearAllAdded=e(a.facetsApplied.container).length>0&&e(a.facetsApplied.container).children(".clear-all-facets").length>0,t.queryText=a.searchParams.search,function(){var s=a.urlParameters,n=u(s.address),l=u(s.latitude),c=u(s.longitude),i=u(s.latlong),o=u(s.search),d=u(s.facets),p=u(s.page);i&&-1!==i.indexOf(",")&&(l=i.split(",")[0],c=i.split(",")[1]);o&&(t.queryText=o);p&&a.results.pager.updateHistory&&(t.currentPage=Math.floor(parseFloat(p)),a.results.pager.loadMore||a.results.pager.infinite?(a.searchParams.skip=0,a.searchParams.top=t.currentPage*a.results.pager.pageSize):a.searchParams.skip=(t.currentPage-1)*a.results.pager.pageSize);d&&(a.facetsSelected=d.split(";"));l&&c&&(a.geoSearch.lat=l,a.geoSearch.lng=c);if(n&&!l&&!c&&!i){var f=function(s){var n=a.googleGeocodeApi;if(!n.key)return;t.waitingLatLong=!0;var l=n.url;l+=-1!==l.indexOf("?")?"&":"?",l+="key="+n.key,l+="&address="+s,l+="&language="+n.language,e.getJSON(l,r)}(n);f&&(l=f[0],c=f[1])}}()),t.fromDate=null,t.toDate=null,t.dateSearch=!1,a.dates.hasDates&&function(){var r=a.dates.fields;if(!r.from.selector||!r.from.indexField)return;var s=r.from.selector;r.to.selector&&r.to.indexField&&r.from.selector?s+=", "+r.to.selector:r.to.selector&&r.to.indexField&&(s=r.to.selector);var n=e(s);function l(){n.each(function(a,t){c(e(t).val(),e(t).data("dateDir"))}),a.searchParams.skip=0,t.currentPage=1,d()}function c(e,a){if(t[a]=null,e&&a){var r=e.split("/"),s=parseInt(r[2]),n=parseInt(r[1])-1,l=parseInt(r[0]),c=new Date(s,n,l,0,0,0,0);"toDate"===a&&c.setHours(23,59,59,999),t[a]=c}t.fromDate||t.toDate?t.dateSearch=!0:t.dateSearch=!1}n.each(function(a,t){e(t).val()&&c(e(t).val(),e(t).data("dateDir"))}),n.on("change",function(e){l()}),n.on("keydown",function(a){13===a.which?(a.preventDefault(),l()):8!==a.which&&46!==a.which||(a.preventDefault(),e(this).val(""),l())})}(),n){case"search":d();break;case"resetFacets":a.facetsSelected=[],a.facets.onFacetSelect.call(a.facetsSelected),d()}return t.initialized||(e(a.facetsSelected).each(function(e,t){a.facets.onFacetSelect.call([t])}),a.orderbyOptions.orderbySelector&&e(document).on(a.orderbyOptions.orderbyEvent,a.orderbyOptions.orderbySelector,a.orderbyOptions.onOrderbyChange)),this.loadAdditionalFacets=i,t.initialized=!0,this}}(jQuery);